#!/bin/bash
# Pre-commit hook for intelligent-max-mcp

echo "Running pre-commit checks..."

# Activate conda environment
source /opt/anaconda3/etc/profile.d/conda.sh
conda activate intelligent-max-mcp

# Run formatting
echo "Formatting code..."
black src/ tests/
isort src/ tests/

# Run linting
echo "Running linting..."
flake8 src/ tests/
if [ $? -ne 0 ]; then
    echo "Linting failed. Please fix the issues before committing."
    exit 1
fi

# Run type checking
echo "Running type checking..."
mypy src/
if [ $? -ne 0 ]; then
    echo "Type checking failed. Please fix the issues before committing."
    exit 1
fi

# Run tests
echo "Running tests..."
pytest tests/ -q
if [ $? -ne 0 ]; then
    echo "Tests failed. Please fix the issues before committing."
    exit 1
fi

echo "All pre-commit checks passed!"